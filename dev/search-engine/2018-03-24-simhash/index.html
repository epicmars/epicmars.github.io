<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" >
        <meta lang="zh">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>网络爬虫页面去重技术 | 风格与布局</title>
<meta name="description" content="最近在使用ElasticSearch搭建一个小型的全文搜索引擎，用来搜索技术博客站点的文章。目前开发阶段爬取的站点60个左右，主要是国内的技">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/solid.css" integrity="sha384-TbilV5Lbhlwdyc4RuIV/JhD8NR+BfMrvz4BL5QFa2we1hQu6wvREr3v6XSRfCTRp" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/brands.css" integrity="sha384-7xAnn7Zm3QC1jFjVc1A6v/toepoG3JXboQYzbM0jrPzou9OFXm/fY6Z/XiIebl/k" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/fontawesome.css" integrity="sha384-ozJwkrqb90Oa3ZNb+yKFW2lToAWYdTiF1vt8JiH5ptTGHTGcN7qdoR1F95e0kYyG" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
        
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="screen" href="/css/article.css" />

    </head>

    <body>
        <div class="site-wrapper">
                <header>
    <nav>
        <a class="home" href="https://www.androidpi.com/">首页</a>
    </nav>
    
</header>
                <div class="site-main">
                    
    <div class="main">
        <div class="article">
            <aside>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#页面去重">页面去重</a>
      <ul>
        <li><a href="#去除完全一样的页面">去除完全一样的页面</a></li>
        <li><a href="#去除相似页面">去除相似页面</a></li>
      </ul>
    </li>
    <li><a href="#google搜索去重技术">Google搜索去重技术</a>
      <ul>
        <li><a href="#simhash算法">Simhash算法</a></li>
        <li><a href="#查询">查询</a></li>
      </ul>
    </li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
            </aside>
            <article>
                <div class="title">
                    <h1 id="title">网络爬虫页面去重技术</h1>
                </div>
                <div class="content">
                        <p>最近在使用ElasticSearch搭建一个小型的全文搜索引擎，用来搜索技术博客站点的文章。目前开发阶段爬取的站点60个左右，主要是国内的技术博客站点，页面共有近9万个，占用空间6G，平均每个页面66KB，然而这其中存在相当多相同或内容相近的页面。根据一项统计，全球开发人员有2千万左右，拥有个人博客的开发者按1%计算，那么可能有数十万开发人员拥有自己的博客站点。如果后续爬取站点达到增加100倍达到6000个，那么爬取页面数可能达到900万，占用空间可能会达到600G左右。</p>
<p>在爬取页面过程中，下载一个页面，提取其中的链接，并根据提取到的链接继续下载页面。由于不同的链接可以指向同一页面，单纯根据链接的特征难以判断两个页面的内容是否是一样的，因此下载的页面可能会有相当多的重复。例如在一篇文章中，正文后有大量评论，每个评论中的链接都指向该页面。由于爬取的页面数和占用空间都极其庞大，为了去除重复的页面，在页面下载后需要一种在时间和空间复杂度都较为高效的方法来判断并去除重复的页面，这种技术在大数据处理和搜索引擎中是必备的。</p>
<h2 id="页面去重">页面去重</h2>
<h3 id="去除完全一样的页面">去除完全一样的页面</h3>
<h4 id="校验和">校验和</h4>
<p>使用CRC或者MD5，SHA等来计算页面的校验和，如果两个页面的校验和相同，那么基本可以认为这两个页面是一样的。</p>
<h3 id="去除相似页面">去除相似页面</h3>
<h4 id="特征空间距离">特征空间距离</h4>
<p>将文本特征映射到一个高维度的空间中，那么可以根据文本特征向量间的距离来判断其相似性。</p>
<h2 id="google搜索去重技术">Google搜索去重技术</h2>
<h3 id="simhash算法">Simhash算法</h3>
<p>它与信息摘要的目的正好相反，信息摘要计算出的哈希值需要尽可能以相同的概率分布在哈希值大小限定的空间中，对于非常相似的文本，即使只有一个字符的差别，信息摘要计算出的哈希值可能完全不同，而对于相似文本SimHash计算出的Hash值则尽可能相似，它属于对内容局部敏感性哈希(Locality Sensitive Hashing)。在用于比较文本相似度算法中，它本质上仍然是一种文本到特征向量的映射，但是映射的特征空间从多维降到了一维。</p>
<p>在Google的研究论文<a href="http://www.wwwconference.org/www2007/papers/paper215.pdf">2</a>中采用了simhash，计算指纹的方法如下：</p>
<ol>
<li>将一个网页转换为一个特征集，每个特征标记一个权重。
特征的提取使用标准的IR(Information Retrival)技术，如分词，大小写转换，停用词去除，词干提取和短语检测。</li>
<li>将步骤1中高纬度的特征向量转换为一个f比特的指纹，其中f是一个较小的值，例如64。
计算方法如下：维护一个f个维度的向量V，每个维度初始化为0。给定从步骤1中提取的特征，将一个特征哈希到一个f比特的值。这些f比特（对每个特征是唯一的）对向量V中f个元素在对应比特位置增加/减去其特征的权值：如果第i个比特的hash值是1，那么向量V的第i个元素增加该特征的权值，如果是0，则减去该特征的权值。当处理完所有特征后，V的某些元素是负值，有些是正值。这些元素的符号确定了最终指纹的对应比特值。</li>
</ol>
<h3 id="查询">查询</h3>
<p>在将文档转换为simhash指纹后，如何快速查找到其它与之最多仅有3个比特不同的指纹？考虑一个有$2^d$个完全随机的f比特指纹的排序表。仅关注表中最高有效的d位。这些d位数字“几乎”相当于一个计数值，因为有较少的$2^d$比特组合存在，并且它们很少重复。另一方面最低有效的$f-d$位“几乎”是随机的。</p>
<p>现在选择$d'$使得$|d&rsquo;-d|$是一个小整形值。因为表是经过排序的，单个探测就可以找出所有与指纹F的$d'$个最高有效位匹配的其它指纹。因为$|d&rsquo;-d|$较小，这些匹配的数量也应当较小。对于每个匹配的指纹，可以容易地在$f - d'$个最低有效位限定的空间中找出与F最多有k位不同的那些指纹。</p>
<h2 id="参考">参考</h2>
<ul>
<li></li>
<li></li>
</ul>

                </div>
                
            </article>
        </div>
    </div>

                </div>
                <footer>
    Powered by <a target="_blank" href="https://gohugo.io/">Hugo</a> And 
    <a target="_blank" href="https://pages.github.com/">Github Pages</a>
</footer>
                <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
                

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.js"></script>

                <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.12.0/styles/default.min.css">
                <script src="/js/highlight.pack.js"></script>
                <script src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script>
                <script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [
                ['$', '$'],
                ['\\(', '\\)']
            ],
            displayMath: [
                ['$$', '$$']
            ],
            processEscapes: true,
            processEnvironments: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            TeX: {
                equationNumbers: {
                    autoNumber: "AMS"
                },
                extensions: ["AMSmath.js", "AMSsymbols.js"]
            }
        }
    });
    MathJax.Hub.Queue(function () {



        var all = MathJax.Hub.getAllJax(),
            i;
        for (i = 0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });

    MathJax.Hub.Config({

        TeX: {
            equationNumbers: {
                autoNumber: "AMS"
            }
        }
    });
</script>
                <script type="text/javascript" src="/js/main.js"></script>
        </div>
    </body>

</html>